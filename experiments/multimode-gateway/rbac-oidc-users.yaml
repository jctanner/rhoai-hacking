---
# ClusterRoleBinding for OIDC users to have admin access
# Adjust this based on your security requirements
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: oidc-users-admin
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: User
    name: oidc:admin # This matches users with username "admin" from OIDC
    apiGroup: rbac.authorization.k8s.io
  - kind: User
    name: oidc:jctanner # Add your username here
    apiGroup: rbac.authorization.k8s.io

---
# ClusterRoleBinding for OIDC groups
# This gives admin access to users in the "admins" group from OIDC
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: oidc-groups-admin
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: Group
    name: oidc:admins # This matches the "admins" group from OIDC
    apiGroup: rbac.authorization.k8s.io

---
# More restrictive binding for regular users
# Gives read-only access to users in the "users" group
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: oidc-groups-readonly
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: view
subjects:
  - kind: Group
    name: oidc:users # This matches the "users" group from OIDC
    apiGroup: rbac.authorization.k8s.io

---
# ServiceAccount for testing JWT authentication
apiVersion: v1
kind: ServiceAccount
metadata:
  name: jwt-test-sa
  namespace: default

---
# ClusterRoleBinding for the test ServiceAccount
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: jwt-test-sa-admin
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: ServiceAccount
    name: jwt-test-sa
    namespace: default
